<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Electron API Demos</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/task.css">
    <!-- Temp. use of CDN version of highlighting  -->
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="task-page">
    <header class="communication">
      <div class="wrapper">
        <div class="nav"><a class="back no-dec" href="../../index.html">Back</a></div>
        <h1>Communication</h1>
        <h3>The <code>ipc</code> (inter-process communication) module allows you to send and recieve synchronous and asynchronous messages between the main and renderer processes. There is a version of it available for both processes.</h3>

        <p>Open the <a href="http://electron.atom.io/docs/v0.36.0/api/web-contents/#webcontents-print-options">full API documentation</a> in your browser.</p>
      </div>
    </header>

    <section class="communication">
      <div class="wrapper">
        <h2 class="js-container-target">Asynchronous messages
        <div class="support avoid-clicks">Supports: Win, OS X, Linux</div>
        </h2>
        <div class="toggle-content">
          <button id="async-msg">Ping</button><span id="async-reply"></span>
          <p>Using <code>ipc</code> to send messages between processes asynchronously is the preferred method since it will return when finished without blocking other operations. This example sends a "ping" from this process (renderer) to the main process. The main process then replies with "pong".</p>
          <h5>Renderer Process</h5>
          <pre><code id="async-msg-render"></pre></code>
          <h5>Main Process</h5>
          <pre><code id="async-msg-main"></code></pre>
        </div>
      </div>
    </section>

    <div class="sections">
      <section class="communication">
        <div class="wrapper">
          <h2 class="js-container-target">Synchronous messages
          <div class="support avoid-clicks">Supports: Win, OS X, Linux</div>
          </h2>
          <div class="toggle-content">
            <button id="sync-msg">Ping</button><span id="sync-reply"></span>
            <p>Use <code>ipc</code> when you need to send synchronous messages between processes. Note that the synchronous nature of this method means that it will block other operations while it is completing its task. This example sends a synchronous message, "ping", from this process (renderer) to the main process. The main process then replies with "pong".</p>
            <h5>Renderer Process</h5>
            <pre><code id="sync-msg-render"></pre></code>
            <h5>Main Process</h5>
            <pre><code id="sync-msg-main"></code></pre>
          </div>
        </div>
      </section>

      <div class="sections">
        <section class="communication">
          <div class="wrapper">
            <h2 class="js-container-target">Communication with an invisible window
            <div class="support avoid-clicks">Supports: Win, OS X, Linux</div>
            </h2>
            <div class="toggle-content">
              <button id="invis-msg">Ping</button><span id="invis-reply"></span>
              <p>Use <code>ipc</code> when you need to send synchronous messages between processes. Note that the synchronous nature of this method means that it will block other operations while it is completing its task. This example sends a synchronous message, "ping", from this process (renderer) to the main process. The main process then replies with "pong".</p>
              <h5>Renderer Process</h5>
              <pre><code id="invis-msg-render"></pre></code>
              <h5>Invisible Window Page HTML</h5>
              <pre><code id="invis-window-render"></code></pre>
            </div>
          </div>
        </section>
  </div>

    <script type="text/javascript" src="../../render-process/communication/sync-msg.js"></script>
    <script type="text/javascript" src="../../render-process/communication/async-msg.js"></script>
    <script type="text/javascript" src="../../render-process/communication/invisible-msg.js"></script>

    <script type="text/javascript">
      var demoBtns = document.querySelectorAll('.js-container-target');
      Array.prototype.forEach.call(demoBtns, function (btn) {
        btn.addEventListener('click', function (event) {
          if (event.target.parentElement.classList.contains('active')) {
            event.target.parentElement.classList.remove('active')
          } else {
            event.target.parentElement.classList.add('active')
          };
        });
      });
    </script>

    <script type="text/javascript">
      var fs = require('fs');
      // Sync Message
      var syncMsgRendererContent = fs.readFileSync('render-process/communication/sync-msg.js');
      document.getElementById('sync-msg-render').innerHTML= syncMsgRendererContent;
      var syncMsgMainContent = fs.readFileSync('main-process/communication/sync-msg.js');
      document.getElementById('sync-msg-main').innerHTML= syncMsgMainContent;
      // Async Message
      var asyncMsgRendererContent = fs.readFileSync('render-process/communication/async-msg.js');
      document.getElementById('async-msg-render').innerHTML= asyncMsgRendererContent;
      var asyncMsgMainContent = fs.readFileSync('main-process/communication/async-msg.js');
      document.getElementById('async-msg-main').innerHTML= asyncMsgMainContent;
      // Invisible Window Message
      var invisMsgRendererContent = fs.readFileSync('render-process/communication/invisible-msg.js');
      document.getElementById('invis-msg-render').innerHTML= invisMsgRendererContent;
      var invisWindowRendererContent = fs.readFileSync('sections/communication/invisible.html');
      document.getElementById('invis-window-render').textContent = invisWindowRendererContent;
    </script>
  </body>
</html>
